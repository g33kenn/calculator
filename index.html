<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dark Mode Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for a better look and feel */
        body {
            font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent; /* Removes blue tap highlight on mobile */
        }
        .calculator-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
        }
        .btn {
            @apply w-full h-16 rounded-lg text-2xl font-medium flex items-center justify-center transition-all duration-200 ease-in-out;
        }
        .btn:active {
            transform: scale(0.95);
        }
        .btn-number {
            @apply bg-gray-200 text-black hover:bg-gray-300;
        }
        .btn-operator {
            @apply bg-orange-500 text-white hover:bg-orange-600;
        }
        .btn-action {
            @apply bg-gray-400 text-black hover:bg-gray-500;
        }
        .span-two {
            grid-column: span 2;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">

    <!-- Calculator Body -->
    <div class="w-full max-w-sm p-6 bg-white rounded-2xl shadow-lg">
        
        <!-- Display Screen -->
        <div id="display" class="bg-gray-200 text-black text-5xl text-right rounded-lg mb-6 p-4 break-words">
            0
        </div>

        <!-- Buttons Grid -->
        <div class="calculator-grid">
            <!-- Row 1 -->
            <button class="btn btn-action" onclick="clearDisplay()">AC</button>
            <button class="btn btn-action" onclick="toggleSign()">+/-</button>
            <button class="btn btn-action" onclick="inputPercent()">%</button>
            <button class="btn btn-operator" onclick="inputOperator('/')">÷</button>

            <!-- Row 2 -->
            <button class="btn btn-number" onclick="inputDigit('7')">7</button>
            <button class="btn btn-number" onclick="inputDigit('8')">8</button>
            <button class="btn btn-number" onclick="inputDigit('9')">9</button>
            <button class="btn btn-operator" onclick="inputOperator('*')">×</button>

            <!-- Row 3 -->
            <button class="btn btn-number" onclick="inputDigit('4')">4</button>
            <button class="btn btn-number" onclick="inputDigit('5')">5</button>
            <button class="btn btn-number" onclick="inputDigit('6')">6</button>
            <button class="btn btn-operator" onclick="inputOperator('-')">−</button>

            <!-- Row 4 -->
            <button class="btn btn-number" onclick="inputDigit('1')">1</button>
            <button class="btn btn-number" onclick="inputDigit('2')">2</button>
            <button class="btn btn-number" onclick="inputDigit('3')">3</button>
            <button class="btn btn-operator" onclick="inputOperator('+')">+</button>

            <!-- Row 5 -->
            <button class="btn btn-number span-two" onclick="inputDigit('0')">0</button>
            <button class="btn btn-number" onclick="inputDecimal()">.</button>
            <button class="btn btn-operator" onclick="calculate()">=</button>
        </div>
    </div>

    <script>
        // --- DOM Elements ---
        const display = document.getElementById('display');

        // --- Calculator State ---
        let currentValue = '0';
        let firstOperand = null;
        let operator = null;
        let waitingForSecondOperand = false;

        // --- Functions ---

        /**
         * Updates the display with the current value.
         */
        function updateDisplay() {
            display.textContent = currentValue;
        }

        /**
         * Handles digit input.
         * @param {string} digit - The digit that was clicked.
         */
        function inputDigit(digit) {
            if (waitingForSecondOperand) {
                currentValue = digit;
                waitingForSecondOperand = false;
            } else {
                currentValue = currentValue === '0' ? digit : currentValue + digit;
            }
            updateDisplay();
        }

        /**
         * Handles decimal point input.
         */
        function inputDecimal() {
            if (waitingForSecondOperand) {
                currentValue = '0.';
                waitingForSecondOperand = false;
                updateDisplay();
                return;
            }
            if (!currentValue.includes('.')) {
                currentValue += '.';
            }
            updateDisplay();
        }

        /**
         * Handles operator input.
         * @param {string} nextOperator - The operator that was clicked.
         */
        function inputOperator(nextOperator) {
            const inputValue = parseFloat(currentValue);

            if (operator && waitingForSecondOperand) {
                operator = nextOperator;
                return;
            }

            if (firstOperand === null) {
                firstOperand = inputValue;
            } else if (operator) {
                const result = performCalculation[operator](firstOperand, inputValue);
                currentValue = `${parseFloat(result.toFixed(7))}`;
                firstOperand = result;
            }

            waitingForSecondOperand = true;
            operator = nextOperator;
            updateDisplay();
        }
        
        /**
         * Toggles the sign of the current value.
         */
        function toggleSign() {
            currentValue = (parseFloat(currentValue) * -1).toString();
            updateDisplay();
        }

        /**
         * Converts the current value to a percentage.
         */
        function inputPercent() {
            currentValue = (parseFloat(currentValue) / 100).toString();
            updateDisplay();
        }


        /**
         * Object containing calculation functions.
         */
        const performCalculation = {
            '/': (first, second) => {
                if (second === 0) {
                    return 'Error';
                }
                return first / second;
            },
            '*': (first, second) => first * second,
            '+': (first, second) => first + second,
            '-': (first, second) => first - second,
        };
        
        /**
         * Performs the final calculation when '=' is pressed.
         */
        function calculate() {
            if (operator && !waitingForSecondOperand) {
                const inputValue = parseFloat(currentValue);
                const result = performCalculation[operator](firstOperand, inputValue);
                
                if (result === 'Error') {
                    currentValue = 'Error';
                } else {
                    currentValue = `${parseFloat(result.toFixed(7))}`;
                }

                firstOperand = null;
                operator = null;
                waitingForSecondOperand = true; // Ready for a new calculation
                updateDisplay();
            }
        }

        /**
         * Resets the calculator to its initial state.
         */
        function clearDisplay() {
            currentValue = '0';
            firstOperand = null;
            operator = null;
            waitingForSecondOperand = false;
            updateDisplay();
        }

        // --- Initial Call ---
        updateDisplay();

        // --- Keyboard Support ---
        document.addEventListener('keydown', (event) => {
            const key = event.key;

            if (key >= '0' && key <= '9') {
                inputDigit(key);
            } else if (key === '.') {
                inputDecimal();
            } else if (key === '+' || key === '-' || key === '*' || key === '/') {
                inputOperator(key);
            } else if (key === 'Enter' || key === '=') {
                calculate();
            } else if (key === 'Escape') {
                clearDisplay();
            } else if (key === '%') {
                inputPercent();
            }
        });
    </script>

</body>
</html>
